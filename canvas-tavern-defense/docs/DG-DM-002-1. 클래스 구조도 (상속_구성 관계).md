1. 클래스 구조도 (상속/구성 관계)

classDiagram direction TB

class GameLoop { +start() +stop() +update(tickCount) +draw(ctx) -fixedFPS -tickCount } class SceneManager { +push(scene) +pop() +replace(scene) +getActiveScene() } class Scene { +update(tickCount) +draw(ctx) +add(obj) +remove(obj) -objects -sort() } class EventBus { +on(event, handler) +off(event, handler) +emit(event, payload) }

GameLoop --> SceneManager : drives SceneManager --> Scene : manages Scene --> EventBus : emits/consumes

class GameRules { +update(tickCount) +switchPhase() -phase } Scene --> GameRules : owns

class OperationManager { +update(tickCount) +spawnCustomer() +rollBuilding() +placeTile() +mergeTiles() +produceFood() +consumeFood() } class BattleManager { +update(tickCount) +spawnMonster() +selectMonsterType() +manageWave() } GameRules --> OperationManager : phase GameRules --> BattleManager : phase

class Stage { +getDifficultyParams() } class TileManager { +place(tile, pos) +merge(a,b) +isWalkable(pos) +getTile(pos) } Stage *-- TileManager : owns

class DataTable { <<singleton>> +getMonster(id) +getPlayer(id) +getFood(id) +getTile(id) } GameRules --> DataTable : reads OperationManager --> DataTable : reads BattleManager --> DataTable : reads

class InputManager { +onTouch() +onDragStart() +onDragMove() +onDrop() } InputManager --> EventBus : emits

class UIManager { +update() +draw() } UIManager --> EventBus : emits/consumes

class TelegramWrapper { +init() +haptics() +storage() +analytics() } GameLoop --> TelegramWrapper : optional hooks