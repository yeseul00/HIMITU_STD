# ğŸš€ ë°°í¬ ìë™í™” êµ¬í˜„ ê°€ì´ë“œ

> Gemini Code Assist ì‘ì—…ìš©  
> ì‘ì„±ì¼: 2025-01-11  
> ëª©ì : GitHub Actions ìë™ ë²„ì „ ê´€ë¦¬ ì‹œìŠ¤í…œ êµ¬ì¶•

---

## ğŸ“‹ êµ¬í˜„ ëª©í‘œ

```
âœ… Git Push ì‹œ ìë™ìœ¼ë¡œ ë²„ì „ ìƒì„±
âœ… index.htmlì— ?v=íƒ€ì„ìŠ¤íƒ¬í”„ ìë™ ì£¼ì…
âœ… version.js ìë™ ìƒì„±/ì—…ë°ì´íŠ¸
âœ… í…”ë ˆê·¸ë¨ ìºì‹± ë¬¸ì œ ì™„ì „ í•´ê²°
```

---

## ğŸ“ ìƒì„±/ìˆ˜ì •í•  íŒŒì¼

```
canvas-tavern-defense/
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â””â”€â”€ deploy.yml          # [ìƒì„±] GitHub Actions ì›Œí¬í”Œë¡œìš°
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ version.js              # [ìƒì„±] ë²„ì „ ì •ë³´ (ìë™ ìƒì„±)
â”‚   â””â”€â”€ main.js                 # [ìˆ˜ì •] version.js import ì¶”ê°€
â””â”€â”€ index.html                  # [ìˆ˜ì •] ìºì‹œ ë°©ì§€ ë©”íƒ€íƒœê·¸ ì¶”ê°€
```

---

## ğŸ”§ Step 1: GitHub Actions ì›Œí¬í”Œë¡œìš° ìƒì„±

### íŒŒì¼: `.github/workflows/deploy.yml`

**ìƒˆë¡œ ìƒì„±í•˜ëŠ” íŒŒì¼ì…ë‹ˆë‹¤. ì „ì²´ ë‚´ìš©ì„ ë³µì‚¬í•˜ì„¸ìš”.**

```yaml
name: Deploy to GitHub Pages

on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    steps:
      - name: ğŸ“¥ Checkout Repository
        uses: actions/checkout@v3
      
      - name: ğŸ“¦ Inject Version Information
        run: |
          # íƒ€ì„ìŠ¤íƒ¬í”„ ìƒì„±
          BUILD_TIME=$(date -u +"%Y%m%d%H%M%S")
          BUILD_DATE=$(date -u +"%Y-%m-%d %H:%M:%S UTC")
          COMMIT_SHA_SHORT="${GITHUB_SHA:0:7}"
          
          echo "=========================================="
          echo "ğŸ“¦ Build Version: $BUILD_TIME"
          echo "ğŸ“… Build Date: $BUILD_DATE"
          echo "ğŸ”– Commit: $COMMIT_SHA_SHORT"
          echo "ğŸ”¢ Run Number: ${{ github.run_number }}"
          echo "=========================================="
          
          # src ë””ë ‰í† ë¦¬ ìƒì„± (ì—†ì„ ê²½ìš°)
          mkdir -p src
          
          # version.js ìë™ ìƒì„±
          cat > src/version.js << 'EOF'
          // âš ï¸ AUTO-GENERATED FILE - DO NOT EDIT MANUALLY
          // This file is automatically generated by GitHub Actions
          
          export const APP_VERSION = 'BUILD_TIME_PLACEHOLDER';
          export const BUILD_DATE = 'BUILD_DATE_PLACEHOLDER';
          export const COMMIT_SHA = 'COMMIT_SHA_PLACEHOLDER';
          export const GITHUB_RUN_NUMBER = RUN_NUMBER_PLACEHOLDER;
          EOF
          
          # í”Œë ˆì´ìŠ¤í™€ë” ì¹˜í™˜
          sed -i "s/BUILD_TIME_PLACEHOLDER/$BUILD_TIME/g" src/version.js
          sed -i "s/BUILD_DATE_PLACEHOLDER/$BUILD_DATE/g" src/version.js
          sed -i "s/COMMIT_SHA_PLACEHOLDER/$COMMIT_SHA_SHORT/g" src/version.js
          sed -i "s/RUN_NUMBER_PLACEHOLDER/${{ github.run_number }}/g" src/version.js
          
          echo "âœ… version.js created:"
          cat src/version.js
          
          # index.html ë²„ì „ ì£¼ì…
          if grep -q 'src/main.js"' index.html; then
            sed -i "s|src/main.js\"|src/main.js?v=$BUILD_TIME\"|g" index.html
            echo "âœ… index.html updated with version parameter"
          else
            echo "âš ï¸ Warning: Could not find 'src/main.js' in index.html"
          fi
          
          # ê²°ê³¼ í™•ì¸
          echo "=========================================="
          echo "ğŸ“„ index.html script tag:"
          grep "src/main.js" index.html || echo "Not found"
          echo "=========================================="
      
      - name: ğŸ“Š Generate Deployment Summary
        run: |
          echo "### ğŸš€ Deployment Summary" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "| Item | Value |" >> $GITHUB_STEP_SUMMARY
          echo "|------|-------|" >> $GITHUB_STEP_SUMMARY
          echo "| **Build Number** | \`${{ github.run_number }}\` |" >> $GITHUB_STEP_SUMMARY
          echo "| **Commit** | \`${{ github.sha }}\` |" >> $GITHUB_STEP_SUMMARY
          echo "| **Branch** | \`${{ github.ref_name }}\` |" >> $GITHUB_STEP_SUMMARY
          echo "| **Author** | ${{ github.actor }} |" >> $GITHUB_STEP_SUMMARY
          echo "| **Timestamp** | $(date -u) |" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### ğŸ“¦ Deployment URL" >> $GITHUB_STEP_SUMMARY
          echo "https://${{ github.repository_owner }}.github.io/${{ github.event.repository.name }}/" >> $GITHUB_STEP_SUMMARY
      
      - name: ğŸš€ Deploy to GitHub Pages
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./
          user_name: 'github-actions[bot]'
          user_email: 'github-actions[bot]@users.noreply.github.com'
          commit_message: 'Deploy: Build #${{ github.run_number }}'
      
      - name: âœ… Deployment Complete
        run: |
          echo "=========================================="
          echo "ğŸ‰ Deployment Successful!"
          echo "ğŸŒ URL: https://${{ github.repository_owner }}.github.io/${{ github.event.repository.name }}/"
          echo "ğŸ“¦ Version: $(date -u +"%Y%m%d%H%M%S")"
          echo "=========================================="
```

---

## ğŸ”§ Step 2: version.js í…œí”Œë¦¿ ìƒì„±

### íŒŒì¼: `src/version.js`

**ìƒˆë¡œ ìƒì„±í•˜ëŠ” íŒŒì¼ì…ë‹ˆë‹¤. GitHub Actionsê°€ ì´ íŒŒì¼ì„ ë®ì–´ì”ë‹ˆë‹¤.**

```javascript
// âš ï¸ AUTO-GENERATED FILE - DO NOT EDIT MANUALLY
// This file is automatically generated by GitHub Actions

export const APP_VERSION = 'dev';
export const BUILD_DATE = 'Development Build';
export const COMMIT_SHA = 'local';
export const GITHUB_RUN_NUMBER = 0;
```

---

## ğŸ”§ Step 3: main.js ìˆ˜ì •

### íŒŒì¼: `src/main.js`

**ê¸°ì¡´ íŒŒì¼ì„ ìˆ˜ì •í•©ë‹ˆë‹¤. ì•„ë˜ ë³€ê²½ì‚¬í•­ì„ ì ìš©í•˜ì„¸ìš”.**

### ë³€ê²½ 1: import ì¶”ê°€ (íŒŒì¼ ë§¨ ìœ„)

```javascript
import { TelegramAPI } from './telegram/TelegramAPI.js';
import { CanvasRenderer } from './core/CanvasRenderer.js';
import { TARGET_FPS, DEBUG } from './utils/constants.js';

// â¬‡ï¸ ì´ ì¤„ ì¶”ê°€
import { APP_VERSION, BUILD_DATE, COMMIT_SHA, GITHUB_RUN_NUMBER } from './version.js';
```

### ë³€ê²½ 2: Game í´ë˜ìŠ¤ì— ë©”ì„œë“œ ì¶”ê°€

```javascript
class Game {
  constructor() {
    // â¬‡ï¸ ì´ ì¤„ ì¶”ê°€ (í…”ë ˆê·¸ë¨ ì´ˆê¸°í™” ì „ì—)
    this.logVersionInfo();
    
    // í…”ë ˆê·¸ë¨ API ì´ˆê¸°í™”
    this.telegram = new TelegramAPI();
    
    // ë Œë”ëŸ¬ ì´ˆê¸°í™”
    this.renderer = new CanvasRenderer('gameCanvas');
    
    // ... ë‚˜ë¨¸ì§€ ê¸°ì¡´ ì½”ë“œ ...
  }

  // â¬‡ï¸ ì´ ë©”ì„œë“œ ì¶”ê°€
  logVersionInfo() {
    const style1 = 'color: #4a90e2; font-weight: bold; font-size: 14px';
    const style2 = 'color: #4a90e2';
    const style3 = 'color: #666';
    
    console.log('%c' + '='.repeat(60), style2);
    console.log('%cğŸ® Tavern Defense - Telegram WebApp', style1);
    console.log('%c' + '='.repeat(60), style2);
    console.log('%cğŸ“¦ Version:', style3, APP_VERSION);
    console.log('%cğŸ“… Build Date:', style3, BUILD_DATE);
    console.log('%cğŸ”– Commit:', style3, COMMIT_SHA);
    console.log('%cğŸ”¢ Build #:', style3, GITHUB_RUN_NUMBER);
    console.log('%c' + '-'.repeat(60), style2);
    console.log('%cğŸŒ User Agent:', style3, navigator.userAgent);
    console.log('%cğŸ“± Platform:', style3, navigator.platform);
    console.log('%cğŸ–¥ï¸ Screen:', style3, `${window.innerWidth}x${window.innerHeight}`);
    console.log('%c' + '='.repeat(60), style2);
  }

  updateInfoPanel() {
    const info = document.getElementById('info');
    const user = this.telegram.getUserInfo();
    
    if (DEBUG.ENABLED) {
      // â¬‡ï¸ ë²„ì „ ì •ë³´ ì¶”ê°€
      info.innerHTML = `
        <strong>ğŸ® Tavern Defense</strong><br>
        ğŸ“¦ v${APP_VERSION.substring(0, 12)}<br>
        ğŸ‘¤ ${user.firstName}<br>
        ${DEBUG.SHOW_FPS ? 'âš¡ <span id="fps">60</span> FPS' : ''}
      `;
    } else {
      info.style.display = 'none';
    }
  }
  
  // ... ë‚˜ë¨¸ì§€ ê¸°ì¡´ ë©”ì„œë“œë“¤ ...
}
```

---

## ğŸ”§ Step 4: index.html ìˆ˜ì •

### íŒŒì¼: `index.html`

**ê¸°ì¡´ íŒŒì¼ì„ ìˆ˜ì •í•©ë‹ˆë‹¤. ì•„ë˜ ë³€ê²½ì‚¬í•­ì„ ì ìš©í•˜ì„¸ìš”.**

### ë³€ê²½ 1: ìºì‹œ ë°©ì§€ ë©”íƒ€íƒœê·¸ ì¶”ê°€ (head ì•ˆì—)

```html
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  
  <!-- â¬‡ï¸ ì´ ë¶€ë¶„ ì¶”ê°€ -->
  <!-- Cache Control -->
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  
  <title>Tavern Defense - Telegram WebApp</title>
  
  <!-- Telegram Web App SDK -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  
  <!-- ë‚˜ë¨¸ì§€ëŠ” ê·¸ëŒ€ë¡œ... -->
```

### ë³€ê²½ 2: script íƒœê·¸ í™•ì¸

```html
  <!-- â¬‡ï¸ ì´ ë¶€ë¶„ì´ ì •í™•íˆ ì´ë ‡ê²Œ ë˜ì–´ìˆëŠ”ì§€ í™•ì¸ -->
  <!-- GitHub Actionsê°€ ìë™ìœ¼ë¡œ ?v=íƒ€ì„ìŠ¤íƒ¬í”„ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤ -->
  <script type="module" src="src/main.js"></script>
</body>
</html>
```

**ì£¼ì˜:** `src="./src/main.js"`ê°€ ì•„ë‹ˆë¼ `src="src/main.js"`ì—¬ì•¼ í•©ë‹ˆë‹¤!

---

## ğŸ”§ Step 5: .gitignore ì—…ë°ì´íŠ¸ (ì„ íƒ)

### íŒŒì¼: `.gitignore`

**version.jsë¥¼ Gitì—ì„œ ì¶”ì í•˜ì§€ ì•Šìœ¼ë ¤ë©´ ì¶”ê°€ (ê¶Œì¥í•˜ì§€ ì•ŠìŒ)**

```gitignore
# GitHub Actionsê°€ ìƒì„±í•˜ë¯€ë¡œ ë¬´ì‹œí•  ìˆ˜ë„ ìˆìŒ
# í•˜ì§€ë§Œ ë¡œì»¬ ê°œë°œì„ ìœ„í•´ í…œí”Œë¦¿ì€ ì»¤ë°‹í•˜ëŠ” ê²Œ ì¢‹ìŒ
# src/version.js
```

**ê¶Œì¥:** version.jsë¥¼ Gitì— í¬í•¨ì‹œí‚¤ë˜, 'dev' í…œí”Œë¦¿ìœ¼ë¡œ ìœ ì§€

---

## âœ… ê²€ì¦ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ë¡œì»¬ì—ì„œ í™•ì¸
```bash
# 1. íŒŒì¼ ìƒì„± í™•ì¸
ls -la .github/workflows/deploy.yml
ls -la src/version.js

# 2. main.js import í™•ì¸
grep "import.*version" src/main.js

# 3. index.html ë©”íƒ€íƒœê·¸ í™•ì¸
grep "Cache-Control" index.html
```

### Git ì‘ì—…
```bash
# 1. ìƒíƒœ í™•ì¸
git status

# 2. ëª¨ë“  íŒŒì¼ ì¶”ê°€
git add .github/workflows/deploy.yml
git add src/version.js
git add src/main.js
git add index.html

# 3. ì»¤ë°‹
git commit -m "[Infra] ë°°í¬ ìë™í™” ì‹œìŠ¤í…œ êµ¬ì¶•

- GitHub Actions ì›Œí¬í”Œë¡œìš° ì¶”ê°€
- ìë™ ë²„ì „ ê´€ë¦¬ ì‹œìŠ¤í…œ
- ìºì‹± ë¬¸ì œ í•´ê²°
- version.js ìë™ ìƒì„±"

# 4. í‘¸ì‹œ
git push origin main
```

### GitHubì—ì„œ í™•ì¸
```
1. Actions íƒ­ ì´ë™
2. "Deploy to GitHub Pages" ì›Œí¬í”Œë¡œìš° ì‹¤í–‰ í™•ì¸
3. ë¡œê·¸ì—ì„œ ë‹¤ìŒ í™•ì¸:
   âœ… ğŸ“¦ Build Version: 20250111153045
   âœ… âœ… version.js created
   âœ… âœ… index.html updated
   âœ… ğŸ‰ Deployment Successful!
```

### í…”ë ˆê·¸ë¨ì—ì„œ í™•ì¸
```
1. ë´‡ Menu Button í´ë¦­
2. F12 ê°œë°œì ë„êµ¬ (Desktop)
3. Consoleì—ì„œ í™•ì¸:
   ğŸ® Tavern Defense
   ğŸ“¦ Version: 20250111153045
   ğŸ“… Build Date: 2025-01-11 15:30:45 UTC
```

---

## ğŸš¨ ë¬¸ì œ í•´ê²°

### Q1: Actions ì‹¤íŒ¨ - "src/main.js not found"
```bash
A: index.htmlì—ì„œ script ê²½ë¡œ í™•ì¸
   src="src/main.js" (O)
   src="./src/main.js" (X)
```

### Q2: version.js import ì—ëŸ¬
```javascript
A: version.js íŒŒì¼ ì¡´ì¬ í™•ì¸
   ë¡œì»¬ì—ì„œëŠ” 'dev' í…œí”Œë¦¿ ì‚¬ìš©
   ë°°í¬ ì‹œì—ëŠ” ìë™ ìƒì„±ë¨
```

### Q3: ì—¬ì „íˆ ìºì‹± ë¬¸ì œ
```
A: BotFatherì—ì„œ URL ë³€ê²½
   https://...github.io/canvas-tavern-defense/?refresh=1
   
   ë˜ëŠ” í…”ë ˆê·¸ë¨ ì•± ìºì‹œ ì‚­ì œ
```

### Q4: Actions ê¶Œí•œ ì—ëŸ¬
```
Settings â†’ Actions â†’ General
â†’ Workflow permissions
â†’ "Read and write permissions" ì„ íƒ
â†’ Save
```

---

## ğŸ“Š ë°°í¬ í›„ í™•ì¸ ë°©ë²•

### 1. Actions ë¡œê·¸ í™•ì¸
```
Actions â†’ Deploy to GitHub Pages â†’ ìµœì‹  ì‹¤í–‰
â†’ "Inject Version Information" ë‹¨ê³„
â†’ ë²„ì „ ì •ë³´ í™•ì¸
```

### 2. ë°°í¬ëœ íŒŒì¼ í™•ì¸
```
GitHub Pages URL/src/version.js ì ‘ì†
â†’ ìµœì‹  ë²„ì „ ì •ë³´ í™•ì¸
```

### 3. ì‹¤ì œ ë¡œë“œ í™•ì¸
```
í…”ë ˆê·¸ë¨ ë´‡ â†’ F12 â†’ Network íƒ­
â†’ main.js?v=20250111153045 í™•ì¸
â†’ version.js í™•ì¸
```

---

## ğŸ¯ ì„±ê³µ ê¸°ì¤€

### ëª¨ë“  í•­ëª©ì´ âœ… ë˜ì–´ì•¼ í•©ë‹ˆë‹¤

- [ ] `.github/workflows/deploy.yml` ìƒì„±
- [ ] `src/version.js` í…œí”Œë¦¿ ìƒì„±
- [ ] `src/main.js` import ì¶”ê°€
- [ ] `index.html` ë©”íƒ€íƒœê·¸ ì¶”ê°€
- [ ] Git push ì™„ë£Œ
- [ ] Actions ì„±ê³µ (ë…¹ìƒ‰ ì²´í¬)
- [ ] GitHub Pages ë°°í¬ ì™„ë£Œ
- [ ] í…”ë ˆê·¸ë¨ì—ì„œ ìƒˆ ë²„ì „ ë¡œë“œ
- [ ] Consoleì— ë²„ì „ ì •ë³´ í‘œì‹œ

---

## ğŸ’¡ Geminiì—ê²Œ ìš”ì²­í•˜ëŠ” ë°©ë²•

### í”„ë¡¬í”„íŠ¸ ì˜ˆì‹œ

```
"ì´ ê°€ì´ë“œ ë³´ê³  ë°°í¬ ìë™í™” êµ¬í˜„í•´ì¤˜.

í•„ìš”í•œ ì‘ì—…:
1. .github/workflows/deploy.yml ìƒì„±
2. src/version.js í…œí”Œë¦¿ ìƒì„±
3. src/main.jsì— version.js import ì¶”ê°€
4. index.htmlì— ìºì‹œ ë°©ì§€ ë©”íƒ€íƒœê·¸ ì¶”ê°€

ê°€ì´ë“œ ê·¸ëŒ€ë¡œ ë”°ë¼ì„œ ëª¨ë“  íŒŒì¼ ìƒì„±/ìˆ˜ì •í•´ì¤˜."
```

---

## ğŸ“š ì°¸ê³  ì •ë³´

### GitHub Actions ë¬¸ì„œ
- https://docs.github.com/en/actions

### Peaceiris gh-pages action
- https://github.com/peaceiris/actions-gh-pages

### í…”ë ˆê·¸ë¨ WebApp ìºì‹±
- https://core.telegram.org/bots/webapps

---

**ì‘ì„±ì¼**: 2025-01-11  
**ë²„ì „**: 1.0  
**ìš©ë„**: Gemini Code Assist ë°°í¬ ìë™í™” êµ¬í˜„
