<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Telegram Mini App Test</title>

  <!-- Telegram Web App SDK -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: var(--tg-theme-bg-color, #1a1a2e);
      color: var(--tg-theme-text-color, #ffffff);
      padding: 20px;
      min-height: 100vh;
    }

    .container {
      max-width: 600px;
      margin: 0 auto;
    }

    h1 {
      color: var(--tg-theme-button-color, #4a90e2);
      margin-bottom: 10px;
      font-size: 24px;
    }

    .subtitle {
      color: var(--tg-theme-hint-color, #888);
      margin-bottom: 30px;
      font-size: 14px;
    }

    .section {
      background: var(--tg-theme-secondary-bg-color, #252540);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
    }

    .section-title {
      color: var(--tg-theme-button-color, #4a90e2);
      font-size: 16px;
      font-weight: bold;
      margin-bottom: 15px;
      border-bottom: 2px solid var(--tg-theme-button-color, #4a90e2);
      padding-bottom: 8px;
    }

    .info-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px;
      background: var(--tg-theme-bg-color, #1a1a30);
      border-radius: 8px;
      margin-bottom: 10px;
    }

    .info-item:last-child {
      margin-bottom: 0;
    }

    .info-label {
      color: var(--tg-theme-hint-color, #888);
      font-size: 14px;
    }

    .info-value {
      color: var(--tg-theme-text-color, #fff);
      font-weight: bold;
      font-size: 14px;
    }

    .badge {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: bold;
    }

    .badge.success {
      background: #2ecc71;
      color: white;
    }

    .badge.warning {
      background: #f39c12;
      color: white;
    }

    .badge.danger {
      background: #e74c3c;
      color: white;
    }

    .badge.info {
      background: #3498db;
      color: white;
    }

    .status {
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      font-weight: 500;
    }

    .status.success {
      background: rgba(46, 204, 113, 0.2);
      border: 1px solid #2ecc71;
      color: #2ecc71;
    }

    .status.error {
      background: rgba(231, 76, 60, 0.2);
      border: 1px solid #e74c3c;
      color: #e74c3c;
    }

    .avatar {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      background: var(--tg-theme-button-color, #4a90e2);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 36px;
      margin: 0 auto 20px;
    }

    .user-name {
      text-align: center;
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 5px;
    }

    .user-username {
      text-align: center;
      color: var(--tg-theme-hint-color, #888);
      margin-bottom: 20px;
    }
  </style>
</head>

<body>
  <div class="container">
    <h1>ğŸ“± Telegram Mini App Test</h1>
    <p class="subtitle">TMA SDK ì´ˆê¸°í™” ë° ìœ ì € ì •ë³´ í…ŒìŠ¤íŠ¸</p>

    <!-- ìƒíƒœ ë©”ì‹œì§€ -->
    <div id="status" class="status success" style="display: none;">
      ì´ˆê¸°í™” ì¤‘...
    </div>

    <!-- í™˜ê²½ ì •ë³´ -->
    <div class="section">
      <div class="section-title">ğŸŒ í™˜ê²½ ì •ë³´</div>
      <div class="info-item">
        <span class="info-label">í”Œë«í¼:</span>
        <span class="info-value" id="platform">í™•ì¸ ì¤‘...</span>
      </div>
      <div class="info-item">
        <span class="info-label">ë²„ì „:</span>
        <span class="info-value" id="version">í™•ì¸ ì¤‘...</span>
      </div>
      <div class="info-item">
        <span class="info-label">TMA ì§€ì›:</span>
        <span class="info-value" id="tmaSupport">í™•ì¸ ì¤‘...</span>
      </div>
    </div>

    <!-- ìœ ì € ì •ë³´ -->
    <div class="section">
      <div class="section-title">ğŸ‘¤ ìœ ì € ì •ë³´</div>
      <div id="userInfo">
        <div class="avatar" id="avatar">?</div>
        <div class="user-name" id="userName">-</div>
        <div class="user-username" id="userUsername">@username</div>

        <div class="info-item">
          <span class="info-label">ìœ ì € ID:</span>
          <span class="info-value" id="userId">-</span>
        </div>
        <div class="info-item">
          <span class="info-label">ì–¸ì–´ ì½”ë“œ:</span>
          <span class="info-value" id="languageCode">-</span>
        </div>
        <div class="info-item">
          <span class="info-label">í”„ë¦¬ë¯¸ì—„:</span>
          <span class="info-value" id="isPremium">-</span>
        </div>
      </div>
    </div>

    <!-- í…Œë§ˆ ì •ë³´ -->
    <div class="section">
      <div class="section-title">ğŸ¨ í…Œë§ˆ ì •ë³´</div>
      <div class="info-item">
        <span class="info-label">ë°°ê²½ìƒ‰:</span>
        <span class="info-value" id="bgColor">-</span>
      </div>
      <div class="info-item">
        <span class="info-label">í…ìŠ¤íŠ¸ ìƒ‰:</span>
        <span class="info-value" id="textColor">-</span>
      </div>
      <div class="info-item">
        <span class="info-label">ë²„íŠ¼ ìƒ‰:</span>
        <span class="info-value" id="buttonColor">-</span>
      </div>
    </div>
  </div>

  <script>
        // TMA SDK ì´ˆê¸°í™”
        function initTelegramApp() {
            const tg = window.Telegram?.WebApp;
            
            if (tg) {
                console.log('âœ… Telegram WebApp ê°ì§€ë¨');
                
                // TMA ì´ˆê¸°í™”
                tg.ready();
                tg.expand();
                
                showStatus('âœ… Telegram Mini Appìœ¼ë¡œ ì‹¤í–‰ ì¤‘', 'success');
                
                // í™˜ê²½ ì •ë³´
                document.getElementById('platform').textContent = tg.platform || 'unknown';
                document.getElementById('version').textContent = tg.version || 'unknown';
                document.getElementById('tmaSupport').innerHTML = '<span class="badge success">ì§€ì›ë¨</span>';
                
                // ìœ ì € ì •ë³´
                const user = tg.initDataUnsafe?.user;
                
                if (user) {
                    console.log('ìœ ì € ì •ë³´:', user);
                    
                    // ì•„ë°”íƒ€ (ì´ë¦„ ì²« ê¸€ì)
                    const firstLetter = user.first_name?.charAt(0) || '?';
                    document.getElementById('avatar').textContent = firstLetter;
                    
                    // ì´ë¦„
                    const fullName = [user.first_name, user.last_name].filter(Boolean).join(' ');
                    document.getElementById('userName').textContent = fullName || '-';
                    
                    // ìœ ì €ë„¤ì„
                    document.getElementById('userUsername').textContent = user.username ? `@${user.username}` : '(ìœ ì €ë„¤ì„ ì—†ìŒ)';
                    
                    // ìœ ì € ID
                    document.getElementById('userId').textContent = user.id || '-';
                    
                    // ì–¸ì–´ ì½”ë“œ
                    document.getElementById('languageCode').textContent = user.language_code || '-';
                    
                    // í”„ë¦¬ë¯¸ì—„ ì—¬ë¶€
                    const isPremium = user.is_premium;
                    document.getElementById('isPremium').innerHTML = isPremium 
                        ? '<span class="badge success">â­ Premium</span>'
                        : '<span class="badge info">Standard</span>';
                } else {
                    showFallbackUser();
                }
                
                // í…Œë§ˆ ì •ë³´
                const themeParams = tg.themeParams;
                document.getElementById('bgColor').textContent = themeParams.bg_color || '-';
                document.getElementById('textColor').textContent = themeParams.text_color || '-';
                document.getElementById('buttonColor').textContent = themeParams.button_color || '-';
                
            } else {
                console.log('âš ï¸ Telegram WebApp SDK ì—†ìŒ - í´ë°± ëª¨ë“œ');
                showStatus('âš ï¸ í…”ë ˆê·¸ë¨ ì™¸ë¶€ í™˜ê²½ (í´ë°± ëª¨ë“œ)', 'error');
                
                // í´ë°± ì •ë³´
                document.getElementById('platform').textContent = 'Web Browser';
                document.getElementById('version').textContent = 'N/A';
                document.getElementById('tmaSupport').innerHTML = '<span class="badge danger">ë¯¸ì§€ì›</span>';
                
                showFallbackUser();
                
                // í´ë°± í…Œë§ˆ
                document.getElementById('bgColor').textContent = '#1a1a2e';
                document.getElementById('textColor').textContent = '#ffffff';
                document.getElementById('buttonColor').textContent = '#4a90e2';
            }
        }
        
        // í´ë°± ìœ ì € ì •ë³´ í‘œì‹œ
        function showFallbackUser() {
            document.getElementById('avatar').textContent = 'ğŸ§‘';
            document.getElementById('userName').textContent = 'Test User';
            document.getElementById('userUsername').textContent = '@testuser';
            document.getElementById('userId').textContent = '123456789';
            document.getElementById('languageCode').textContent = 'ko';
            document.getElementById('isPremium').innerHTML = '<span class="badge warning">í…ŒìŠ¤íŠ¸ ëª¨ë“œ</span>';
        }
        
        // ìƒíƒœ ë©”ì‹œì§€ í‘œì‹œ
        function showStatus(message, type = 'success') {
            const statusEl = document.getElementById('status');
            statusEl.textContent = message;
            statusEl.className = `status ${type}`;
            statusEl.style.display = 'block';
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        window.addEventListener('load', () => {
            initTelegramApp();
        });
        
        // ì½˜ì†”ì— ì „ì²´ ë°ì´í„° ì¶œë ¥
        console.log('='.repeat(60));
        console.log('ğŸ“± Telegram Mini App Test');
        console.log('='.repeat(60));
        console.log('WebApp:', window.Telegram?.WebApp);
        console.log('initDataUnsafe:', window.Telegram?.WebApp?.initDataUnsafe);
        console.log('='.repeat(60));
  </script>
</body>

</html>